{"mappings":"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","sources":["src/js/scripts.js"],"sourcesContent":["import { view } from './codemirror/setup.js';\n\nconst navToggle = document.querySelector(\".navToggle\"),\n  nav = document.querySelector(\".nav\"),\n  menuHeaderBtns = document.querySelectorAll(\".nav__item > button\"),\n  menuBtns = document.querySelectorAll(\".nav__dropdown-item > button\"),\n  filenameTitle = document.querySelector(\".filename-title\"),\n  exampleBtns = document.querySelectorAll(\".example-item button\"),\n  regex = document.querySelector(\".regex\");\nlet isMenuOpen = false;\n\n// MENU HEADERS\n\nfunction onMenuHeaderClick(e) {\n  e.preventDefault();\n  let btn = e.currentTarget;\n  isMenuOpen = btn.closest(\".nav__item\")?.classList.toggle(\"nav__item--open\");\n}\n\nfunction onMenuHeaderMouseover(e) {\n  e.preventDefault();\n  let btn = e.currentTarget;\n  if (isMenuOpen) {\n    for (let b of menuHeaderBtns) {\n      b.closest(\".nav__item\")?.classList.remove(\"nav__item--open\");\n    }\n    btn.closest(\".nav__item\")?.classList.add(\"nav__item--open\");\n    btn.focus();\n  }\n}\n\nfunction onMenuHeaderBlur(e) {\n  e.preventDefault();\n  const open = document.querySelector(\".nav__item--open\");\n  if (open) {\n    open.classList.remove(\"nav__item--open\");\n  }\n  isMenuOpen = false;\n  // let btn = e.currentTarget;\n  // btn.parentElement.classList.remove(\"nav__item--open\");\n}\n\n// MENU BTNS\n\nfunction onMenuBtnClick(e) {\n  e.preventDefault();\n  isMenuOpen = false;\n  let btn = e.currentTarget;\n  btn.closest(\".nav__item\")?.classList.remove(\"nav__item--open\");\n}\n\nfunction newFile() {\n  setDoc(\"\");\n  filenameTitle.innerText = \"Untitled\";\n}\n\nfunction loadFile() {\n  const input = document.createElement(\"input\");\n  input.type = \"file\";\n  input.accept = \".coem,.txt\";\n  input.addEventListener(\"input\", e => {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.addEventListener(\"load\", () => {\n        const result = reader.result;\n        setDoc(result);\n        const SEPARATOR = \".\";\n        const filenameParts = file.name.split(SEPARATOR);\n        const filename = filenameParts.slice(0, filenameParts.length - 1).join(SEPARATOR);\n        filenameTitle.innerText = filename;\n      }, false);\n      reader.readAsText(file, \"UTF-8\");\n    }\n  });\n  input.click();\n}\n\nfunction saveFile() {\n  const text = view.state.doc.toString();\n  const blob = new Blob([text], { type: \"text/plain;charset=UTF-8\" });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement(\"a\");\n  a.href = url;\n  const title = filenameTitle.innerText;\n  a.download = `${title}.txt`;\n  a.click();\n}\n\nfunction loadExample(e) {\n  let filename = e.currentTarget.value;\n  load(filename);\n}\n\nfunction load(filename) {\n  fetch(\"./examples/\" + filename + \".coem\")\n  .then(r => r.text())\n  .then((code) => {\n    setDoc(code);\n    filenameTitle.innerText = filename;\n  })\n  .catch(err => console.log(err));\n}\n\nfunction openPopup(e) {\n  regex.classList.add(\"visible\");\n}\n\nfunction closePopup(e) {\n  regex.classList.remove(\"visible\");\n}\n\n// ECHO\n\nfunction handleError(e, source = \"\") {\n  if (!e) return null;\n  console.error(e);\n  const { oneLiner, preErrorSection, errorSection, postErrorSection } = formatCoemError(e, source);\n  let errorStr = oneLiner;\n  if (errorSection) {\n    errorStr += '<br />';\n    errorStr += `${preErrorSection}<span class=\"error\">${errorSection}</span>${postErrorSection}`;\n  }\n}\n\nfunction echo() {\n  // https://github.com/danman113/YALI.js/blob/master/browser.js\n  const source = view.state.doc.toString();\n  console.log(source);\n  const browserEnv = new Environment();\n  try {\n    // run(source, browserEnv, handleOutput);\n    let echo = run(source, browserEnv);\n    setDoc(echo);\n    handleError(null);\n  } catch (e) {\n    handleError(e, source);\n  }\n}\n\n// CHARACTER INPUT\n\nfunction insert(str) {\n  view.dispatch(view.state.replaceSelection(str));\n  view.focus();\n}\n\nfunction setDoc(str) {\n  view.dispatch({ changes: { from: 0, to: view.state.doc.length, insert: str } });\n  view.focus();\n}\n\n// MAIN\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  load(\"docks\");\n\n  // nav\n  navToggle.addEventListener(\"click\", e => {\n    e.preventDefault();\n    if (nav.classList.toggle(\"open\")) {\n      navToggle.innerText = \"×\";\n    } else {\n      navToggle.innerText = \"☰\";\n    }\n    document.body.classList.toggle(\"navIsOpen\");\n  });\n\n  // menu headers\n  menuHeaderBtns.forEach(btn => {\n    btn.addEventListener(\"click\", onMenuHeaderClick);\n    btn.addEventListener(\"mouseover\", onMenuHeaderMouseover);\n  });\n\n  // menu buttons\n  menuBtns.forEach(btn => {\n    btn.addEventListener(\"click\", onMenuBtnClick);\n  })\n\n  // file buttons\n  document.querySelector(\"#newBtn\").addEventListener(\"click\", newFile);\n  document.querySelector(\"#loadBtn\").addEventListener(\"click\", loadFile);\n  document.querySelector(\"#saveBtn\").addEventListener(\"click\", saveFile);\n  \n  // examples\n  exampleBtns.forEach(btn => {\n    btn.addEventListener(\"click\", loadExample);\n  });\n\n  // regex\n  document.querySelector(\"#regexBtn\").addEventListener(\"click\", openPopup);\n  document.querySelector(\".backdrop\").addEventListener(\"click\", closePopup);\n\n  // echo\n  document.querySelector(\"#echoBtn\").addEventListener(\"click\", echo);\n\n  // character input\n  document.querySelector(\"#clearBtn\").addEventListener(\"click\", () => setDoc(\"\"));\n  document.querySelector(\"#commentBtn\").addEventListener(\"click\", () => insert(\"† \"));\n  document.querySelector(\"#dashBtn\").addEventListener(\"click\", () => insert(\"—\"));\n  document.querySelector(\"#colonBtn\").addEventListener(\"click\", () => insert(\":\"));\n  document.querySelector(\"#ampersandBtn\").addEventListener(\"click\", () => insert(\"&\"));\n  document.querySelector(\"#openQuoteBtn\").addEventListener(\"click\", () => insert(\"“\"));\n  document.querySelector(\"#closeQuoteBtn\").addEventListener(\"click\", () => insert(\"”\"));\n  document.querySelector(\"#pipeBtn\").addEventListener(\"click\", () => insert(\"|\"));\n  document.querySelector(\"#openParenBtn\").addEventListener(\"click\", () => insert(\"(\"));\n  document.querySelector(\"#closeParenBtn\").addEventListener(\"click\", () => insert(\")\"));\n  document.querySelector(\"#questionBtn\").addEventListener(\"click\", () => insert(\"?\"));\n  document.querySelector(\"#asteriskBtn\").addEventListener(\"click\", () => insert(\"*\"));\n  document.querySelector(\"#plusBtn\").addEventListener(\"click\", () => insert(\"+\"));\n});\n\ndocument.addEventListener(\"keydown\", e => {\n  if (e.code === \"Escape\") {\n    if (regex.classList.contains(\"visible\")) {\n      regex.classList.remove(\"visible\");\n    }\n    if (isMenuOpen) {\n      const open = document.querySelector(\".nav__item--open\");\n      if (open) {\n        open.classList.remove(\"nav__item--open\");\n      }\n      isMenuOpen = false;\n    }\n  }\n\n  if (e.code === \"ArrowLeft\" || e.code === \"ArrowRight\") {\n    const open = document.querySelector(\".nav__item--open\");\n    if (open) {\n      const others = document.querySelectorAll(\".nav__item\");\n      const index = Array.from(others).indexOf(open);\n      let changeTo = null;\n      if (e.code === \"ArrowLeft\" && index > 0) {\n        changeTo = others[index - 1];\n      } else if (e.code === \"ArrowRight\" && index < others.length - 1) {\n        changeTo = others[index + 1];\n      }\n      if (changeTo) {\n        open.classList.remove(\"nav__item--open\");\n        changeTo.classList.add(\"nav__item--open\");\n      }\n    }\n  }\n});"],"names":["$8BrLS","parcelRequire","$c5788eb2e609bbc3$var$navToggle","document","querySelector","$c5788eb2e609bbc3$var$nav","$c5788eb2e609bbc3$var$menuHeaderBtns","querySelectorAll","$c5788eb2e609bbc3$var$menuBtns","$c5788eb2e609bbc3$var$filenameTitle","$c5788eb2e609bbc3$var$exampleBtns","$c5788eb2e609bbc3$var$regex","$c5788eb2e609bbc3$var$isMenuOpen","$c5788eb2e609bbc3$var$onMenuHeaderClick","e","preventDefault","btn","currentTarget","closest","classList","toggle","$c5788eb2e609bbc3$var$onMenuHeaderMouseover","b","remove","add","focus","$c5788eb2e609bbc3$var$onMenuBtnClick","$c5788eb2e609bbc3$var$newFile","$c5788eb2e609bbc3$var$setDoc","innerText","$c5788eb2e609bbc3$var$loadFile","input","createElement","type","accept","addEventListener","file","target","files","reader","FileReader","result","filenameParts","name","split","filename","slice","length","join","readAsText","click","$c5788eb2e609bbc3$var$saveFile","text","view","state","doc","toString","blob","Blob","url","URL","createObjectURL","a","href","title","download","$c5788eb2e609bbc3$var$loadExample","$c5788eb2e609bbc3$var$load","value","fetch","then","r","code","catch","err","console","log","$c5788eb2e609bbc3$var$openPopup","$c5788eb2e609bbc3$var$closePopup","$c5788eb2e609bbc3$var$handleError","source","error","oneLiner","preErrorSection","errorSection","postErrorSection","formatCoemError","errorStr","$c5788eb2e609bbc3$var$echo","browserEnv","Environment","run","$c5788eb2e609bbc3$var$insert","str","dispatch","replaceSelection","changes","from","to","insert","body","forEach","contains","open","others","index","Array","indexOf","changeTo"],"version":3,"file":"index.12b134c2.js.map"}