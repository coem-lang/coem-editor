{"mappings":"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","sources":["src/js/scripts.js"],"sourcesContent":["import { view } from './codemirror/setup.js';\n\nconst navToggle = document.querySelector(\".navToggle\"),\n  nav = document.querySelector(\".nav\"),\n  menuHeaderBtns = document.querySelectorAll(\".nav__item > button\"),\n  menuBtns = document.querySelectorAll(\".nav__dropdown-item > button\"),\n  filenameTitle = document.querySelector(\".filename-title\"),\n  exampleBtns = document.querySelectorAll(\".example-item button\"),\n  regex = document.querySelector(\".regex\");\nlet isMenuOpen = false;\n\n// MENU HEADERS\n\nfunction onMenuHeaderClick(e) {\n  e.preventDefault();\n  let btn = e.currentTarget;\n  isMenuOpen = btn.parentElement.classList.toggle(\"nav__item--open\");\n}\n\nfunction onMenuHeaderMouseover(e) {\n  e.preventDefault();\n  let btn = e.currentTarget;\n  if (isMenuOpen) {\n    for (let b of menuHeaderBtns) {\n      b.parentElement.classList.remove(\"nav__item--open\");\n    }\n    btn.parentElement.classList.add(\"nav__item--open\");\n    btn.focus();\n  }\n}\n\nfunction onMenuHeaderBlur(e) {\n  // e.preventDefault();\n  // let btn = e.currentTarget;\n  // btn.parentElement.classList.remove(\"nav__item--open\");\n}\n\n// MENU BTNS\n\nfunction onMenuBtnClick(e) {\n  e.preventDefault();\n  isMenuOpen = false;\n  let btn = e.currentTarget;\n  btn.parentElement.parentElement.parentElement.classList.remove(\"nav__item--open\");\n}\n\nfunction newFile() {\n  setDoc(\"\");\n  filenameTitle.innerText = \"Untitled\";\n}\n\nfunction loadExample(e) {\n  let filename = e.currentTarget.value;\n  load(filename);\n}\n\nfunction load(filename) {\n  fetch(\"./examples/\" + filename + \".coem\")\n  .then(r => r.text())\n  .then((code) => {\n    setDoc(code);\n    filenameTitle.innerText = filename;\n  })\n  .catch(err => console.log(err));\n}\n\nfunction openPopup(e) {\n  regex.classList.add(\"visible\");\n}\n\nfunction closePopup(e) {\n  regex.classList.remove(\"visible\");\n}\n\n// REFLECT\n\nfunction handleError(e, source = \"\") {\n  if (!e) return null;\n  console.error(e);\n  const { oneLiner, preErrorSection, errorSection, postErrorSection } = formatCoemError(e, source);\n  let errorStr = oneLiner;\n  if (errorSection) {\n    errorStr += '<br />';\n    errorStr += `${preErrorSection}<span class=\"error\">${errorSection}</span>${postErrorSection}`;\n  }\n}\n\nfunction reflect() {\n  // https://github.com/danman113/YALI.js/blob/master/browser.js\n  const source = view.state.doc.toString();\n  console.log(source);\n  const browserEnv = new Environment();\n  try {\n    // run(source, browserEnv, handleOutput);\n    let echo = run(source, browserEnv);\n    setDoc(echo);\n    handleError(null);\n  } catch (e) {\n    handleError(e, source);\n  }\n}\n\n// CHARACTER INPUT\n\nfunction insert(str) {\n  view.dispatch(view.state.replaceSelection(str));\n  view.focus();\n}\n\nfunction setDoc(str) {\n  view.dispatch({ changes: { from: 0, to: view.state.doc.length, insert: str } });\n  view.focus();\n}\n\n// MAIN\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  load(\"docks\");\n\n  // nav\n  navToggle.addEventListener(\"click\", e => {\n    e.preventDefault();\n    if (nav.classList.toggle(\"open\")) {\n      navToggle.innerText = \"×\";\n    } else {\n      navToggle.innerText = \"☰\";\n    }\n    document.body.classList.toggle(\"navIsOpen\");\n  });\n\n  // menu headers\n  menuHeaderBtns.forEach(btn => {\n    btn.addEventListener(\"click\", onMenuHeaderClick);\n    btn.addEventListener(\"mouseover\", onMenuHeaderMouseover);\n    btn.addEventListener(\"blur\", onMenuHeaderBlur);\n  });\n\n  // menu buttons\n  menuBtns.forEach(btn => {\n    btn.addEventListener(\"click\", onMenuBtnClick);\n  })\n\n  // new\n  document.querySelector(\"#newBtn\").addEventListener(\"click\", newFile);\n  \n  // examples\n  exampleBtns.forEach(btn => {\n    btn.addEventListener(\"click\", loadExample);\n  });\n\n  // regex\n  document.querySelector(\"#regexBtn\").addEventListener(\"click\", openPopup);\n  document.querySelector(\".backdrop\").addEventListener(\"click\", closePopup);\n\n  // reflect\n  document.querySelector(\"#reflectBtn\").addEventListener(\"click\", reflect);\n\n  // character input\n  document.querySelector(\"#clearBtn\").addEventListener(\"click\", () => setDoc(\"\"));\n  document.querySelector(\"#commentBtn\").addEventListener(\"click\", () => insert(\"† \"));\n  document.querySelector(\"#dashBtn\").addEventListener(\"click\", () => insert(\"—\"));\n  document.querySelector(\"#colonBtn\").addEventListener(\"click\", () => insert(\":\"));\n  document.querySelector(\"#ampersandBtn\").addEventListener(\"click\", () => insert(\"&\"));\n  document.querySelector(\"#openQuoteBtn\").addEventListener(\"click\", () => insert(\"“\"));\n  document.querySelector(\"#closeQuoteBtn\").addEventListener(\"click\", () => insert(\"”\"));\n  document.querySelector(\"#pipeBtn\").addEventListener(\"click\", () => insert(\"|\"));\n  document.querySelector(\"#openParenBtn\").addEventListener(\"click\", () => insert(\"(\"));\n  document.querySelector(\"#closeParenBtn\").addEventListener(\"click\", () => insert(\")\"));\n  document.querySelector(\"#questionBtn\").addEventListener(\"click\", () => insert(\"?\"));\n  document.querySelector(\"#asteriskBtn\").addEventListener(\"click\", () => insert(\"*\"));\n  document.querySelector(\"#plusBtn\").addEventListener(\"click\", () => insert(\"+\"));\n});\n\ndocument.addEventListener(\"keydown\", e => {\n  if (e.code === \"Escape\" && regex.classList.contains(\"visible\")) {\n    regex.classList.remove(\"visible\");\n  }\n});"],"names":["$8BrLS","parcelRequire","$c5788eb2e609bbc3$var$navToggle","document","querySelector","$c5788eb2e609bbc3$var$nav","$c5788eb2e609bbc3$var$menuHeaderBtns","querySelectorAll","$c5788eb2e609bbc3$var$menuBtns","$c5788eb2e609bbc3$var$filenameTitle","$c5788eb2e609bbc3$var$exampleBtns","$c5788eb2e609bbc3$var$regex","$c5788eb2e609bbc3$var$isMenuOpen","$c5788eb2e609bbc3$var$onMenuHeaderClick","e","preventDefault","btn","currentTarget","parentElement","classList","toggle","$c5788eb2e609bbc3$var$onMenuHeaderMouseover","b","remove","add","focus","$c5788eb2e609bbc3$var$onMenuHeaderBlur","$c5788eb2e609bbc3$var$onMenuBtnClick","$c5788eb2e609bbc3$var$newFile","$c5788eb2e609bbc3$var$setDoc","innerText","$c5788eb2e609bbc3$var$loadExample","$c5788eb2e609bbc3$var$load","value","filename","fetch","then","r","text","code","catch","err","console","log","$c5788eb2e609bbc3$var$openPopup","$c5788eb2e609bbc3$var$closePopup","$c5788eb2e609bbc3$var$handleError","source","error","oneLiner","preErrorSection","errorSection","postErrorSection","formatCoemError","errorStr","$c5788eb2e609bbc3$var$reflect","view","state","doc","toString","browserEnv","Environment","run","$c5788eb2e609bbc3$var$insert","str","dispatch","replaceSelection","changes","from","to","length","insert","addEventListener","body","forEach","contains"],"version":3,"file":"index.65cbad54.js.map"}